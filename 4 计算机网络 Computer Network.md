# 4 网络和通信 Networking & Communication

## 计算机网络和互联网

### 具体组成

- 硬件和软件+服务+网络协议
- 互联网组成

	- 互联网边缘部分

		- 定义：可以理解为互联网中网络核心以外的部分，用来进行通信和资源共享
		- 主机（端系统，end system）

			- 定义：与互联网相连接的计算设备，可容纳应用程序
			- 可以区分为客户端client 或者服务器 server。或者其他可计算设备的区分方式。
			- 端系统通信：运行在主机 A 上的某个程序和运行在主机 B 上的另一个程序进行通信

				- 客户-服务器方式（C/S方式）
即 Client/Server 方式，简称为 C/S 方式。 客户程序被用户调用后运行，在打算通信时主动向远地服务器发起通信（请求服务）。客户程序必须知道服务器程序的地址。
				- 对等方式（P2P方式）
即 Peer-to-Peer 方式 ，简称为 P2P 方式。从本质上看仍然是使用客户服务器方式，只是对等连接中的每一个主机既是客户又是服务器。

		- 接入网 access network
由ISP（Internet Service Provider）提供

			- 定义：将端系统连接到边缘路由器（edge router）的物理链路
			- 接入技术方案

				- 家庭接入方案：
DSL、电缆、FTTH、拨号、卫星
				- 企业接入方案：
局域网LAN（以太网、Wireless Lan（WIFI））
				- 广域接入方案：
移动蜂窝网络3G和4G（LTE）等

			- 物理链路的物理媒介

	- 互联网核心部分

		- 定义：由分组交换机（链路交换机、路由器）和通信链路构成的网状网络，为边缘部分提供服务（提供连通性和资源交换）
		- 如何在端系统之间传输数据？

			- 分组交换/分组转发（互联网核心部分采用的技术）：
将报文messager分隔为较小的数据块在端系统之间传输，数据块首部加上分组信息作为传输单元，称作包/分组 packet，每个分组都通过通信链路和分组交换机传送packet swith传送。

				- 路由器如何从源获取数据再转发到某条链路？
存储转发机制 store-and-forward transmission、存储转发时延 store-and-forward delay
				- 多个源同时向同一路由器发送数据会怎样？
排队时延queue delay 和分组丢失/丢包packet lost
				- 路由器如何决定选择哪条链路来传输数据到目的地？
转发表forwarding table和路由选择协议routing protocol
				- 分组交换网络中的时延、丢包和吞吐量

			- 电路交换：
在端系统之间建立直接的物理链路连接，称为电路。

				- 同一条物理链路上如何复用？
频分复用（FDM, Frequency-Division Multiplexing）和时分复用（TDM，Time-Division Multiplexing）

			- 报文交换：
和分组交换一样，同样利用了存储转发机制，但没有分组。
			- 两种方案中，分组交换更为推广普及

				- 在分组传输的过程中动态分配传输带宽，对通信链路是逐段占用。
				- 为每一个分组独立地选择最合适的转发路由。
				- 以分组作为传送单位，可以不先建立连接就能向其他主机发送分组。
				- 保证可靠性的网络协议；分布式多路由的分组交换网，使网络有很好的生存性。

		- 网络的网络

			- 通过不同层级的ISP，所有端系统连接到一起
			- 互联网internet，泛指多个计算机网络连接而成的网络
			- 因特网Internet，特指全球最大的计算机网络

### 分类

- 按照网络的作用范围进行分类

	- 广域网 WAN (Wide Area Network)：作用范围通常为几十到几千公里。
	- 城域网 MAN (Metropolitan Area Network)：作用距离约为 5~50 公里。
	- 局域网 LAN (Local Area Network) ：局限在较小的范围（如 1 公里左右）。
	- 个人区域网 PAN (Personal Area Network) ：范围很小，大约在 10 米左右。

- 按照网络的使用者进行分类

	- 公用网 (public network) 
	- 按规定交纳费用的人都可以使用的网络。因此也可称为公众网。
	- 专用网 (private network) 
	- 为特殊业务工作的需要而建造的网络。

- 用来把用户接入到互联网的网络

	- 接入网 AN (Access Network)，它又称为本地接入网或居民接入网。
	- 从作用上看，接入网只是起到让用户能够与互联网连接的“桥梁”作用。接入网本身既不属于互联网的核心部分，也不属于互联网的边缘部分。接入网是从某个用户端系统到互联网中的第一个路由器（也称为边缘路由器）之间的一种网络。
	- 从覆盖的范围看，很多接入网还是属于局域网。

### 性能评估

- 性能指标

	- 速率
	- 带宽
	- 吞吐率
	- 时延
	- 时延带宽积
	- 往返时间 RTT
	- 利用率

- 非性能表征

	- 费用
	- 质量
	- 标准化
	- 可靠性
	- 可扩展性和可升级性 
	- 易于管理和维护 

### 计算机网络的体系结构 (architecture) 

- 协议层次及其服务模型

  计算机网络的体系结构 (architecture) 是计算机网络的各层及其协议的集合。 
  体系结构就是这个计算机网络及其部件所应完成的功能的精确定义。
  实现 (implementation) 是遵循这种体系结构的前提下用何种硬件或软件完成这些功能的问题。
  体系结构是抽象的，而实现则是具体的，是真正在运行的计算机硬件和软件。

	- 开放系统互连基本参考模型 OSI/RM (Open Systems Interconnection Reference Model)，简称为 OSI

		- 网络协议 (network protocol)，简称为协议，是为进行网络中的数据交换而建立的规则、标准或约定。 
·语法：数据与控制信息的结构或格式 。 
·语义：需要发出何种控制信息，完成何种动作以及做出何种响应。 
·同步：事件实现顺序的详细说明。 

	- TCP/IP
（事实上的 (de facto) 国际标准）
	- 因特网协议栈
（综合OSI和TCP/IP)

		- 每一层向它的上层提供服务模型
		- 应用层application layer

			- 功能：网络应用程序存留运行的层，应用层内的信息分组称为报文（message）。应用进程数据先传送到应用层，加上应用首部，称为PDU (Protocol Data Unit)：协议数据单元。
			- 网络协议：HTTP、SMTP、FTP

				- HTTP：Web文档的请求和传送

					- HTTPs:

				- SMTP：电子邮件报文的传输
				- FTP：两个端系统之间的传输

			- 域名系统DNS，Domain Name System，提供域名到网络地址的跳转服务

		- 运输层transport layer

			- 功能：在端系统之间传送应用层的报文，运输层内的信息分组称为报文段（segment）
			- 网络协议：TCP、UDP

				- TCP：向应用程序提供面向连接的服务，确保传递和流量控制。将长报文划分为短报文，提供拥塞控制机制。
				- UDP：向应用程序提供无连接服务，无其他机制。

		- 网络层network layer

			- 功能：网络层内的信息分组称为数据报（datagram），网络层将数据报从一台主机传送到另一台主机
			- 网络协议：IP、路由选择协议

				- IP：定义数据报的字段构成，定义路由器和端系统如何处理数据报
				- 路由选择协议：

		- 数据链路层 (data link layer)

			- 功能：数据链路层内的信息分组称为帧（frame），网络层将数据从一个节点传送到另一台节点（主机或路由器）

		- 物理层 (physical layer) 

			- 物理层协议，双绞铜线、同轴电缆

- 封装机制

	- 应用层报文--封装--运输层报文段--封装--网络层数据报--链路层帧
application-layer message----transport-layer segment----network-layer datagram----link-layer  frame
	- 分组=首部字段+有效载荷
首部字段：本层添加的封装
有效载荷：上一层的分组

## 计算机网络：分层的体系结构

### 应用层

- 应用层协议原理

	- 网络应用程序体系结构

		- 应用程序体系结构由应用程序研发者设计，规定如何在端系统之间组织该应用程序。
		- 主流的体系结构

			- 客户-服务器体系结构

				- Web2.0等应用、电子邮件、FTP、Telnet

			- 对等（P2P）体系结构

				- BTtorrent、Skype
				- 自拓展性

	- 进程通信

		- 网络程序中，不同端系统上的进程跨越计算机网络交换报文message，互相通信
		- 在一次通信行为中，客户进程和服务器进程是相对而言的
		- 进程和计算机网络间的接口，称为套接字socket

	- 应用层所需的运输层协议

		- 运输层可为网络应用程序提供的运输服务

			- 可靠数据传输

				- 容忍丢失的应用

			- 吞吐量

				- 带宽敏感应用
				- 弹性应用

			- 定时保证/延迟少
			- 安全性

		- 对服务有不同要求的程序

			- 文件传输

				- 文件可靠传输、弹性带宽、时间不敏感

			- 视频会议

				- 容忍丢失、带宽要满足一定要求、时间敏感

			- 即时讯息

				- 可靠传输、弹性带宽、时间敏感/不敏感

			- ...等等

		- 运输协议类型

			- TCP协议

				- 提供的服务：
面向连接的服务（TCP三次握手建立连接）、可靠的数据传输服务、拥塞控制机制（使得多个连接能够共享带宽）
				- 没有提供加密服务。
				- SSL，Secure Socket Layer（在应用层上对TCP加强）

					- 提供的服务：
在TCP的基础上，提供加密、数据完整性和端点鉴别

			- UDP协议

				- 仅提供最小量的服务：
没有连接（没有握手过程）、不可靠、无拥塞控制机制。
				- 没有提供加密服务。

			- 没有提供带宽保证和定时保证。现今的应用采用其他设计方法来补充这些缺失。

	- 应用层协议

		- 协议定义的内容

			- 交换的报文类型，比如请求报文和响应报文
			- 不同报文类型的语法，报文中有哪些字段，每种字段如何描述
			- 报文中各字段的语义
			- 报文何时发送、如何发送和如何响应报文的规则。

		- 应用层协议是一个网络应用的重要组成部分

- 网络应用与应用层协议

	- Web与HTTP

		- Web程序

			- Web Page = Objects（对象） + URL（对象之间通过URL地址串联在一起）

				- URL = 主机名 + 路径名

			- HTTP的客户端 = Web browser
流行的有Chrome、Firefox
			- HTTP的服务器端 = Web server
流行的有Apache，存储Web页面

		- HTTP, Hypertext transfer protocol

			- HTTP协议决定了客户端如何向服务器端发送请求报文和接收响应报文，决定了服务器端如何接收请求报文和发送响应报文

				- HTTP是一个无状态协议。HTTP服务器不保存客户的信息，客户端同样的请求得到的响应是一样的
				- HTTP建立在TCP之上，将运输过程中的安全问题、可靠问题交予TCP来处理。

			- 连接方式

				- 持续连接

					- 流水线方式
					- 非流水线方式

				- 非持续连接，每次对象传输都要重新建立TCP连接

			- HTTP报文格式

				- HTTP 请求报文格式

					- 第一部分：请求行

						- 请求方法

							- GET
							- POST
							- OPTIONS
							- TRACE
							- HEAD
							- PUT
							- Others

						- 请求路径URL(即请求的相对路径)
						- 请求协议版本

							- HTTP/1.1
							- HTTP/1.0
							- Others

					- 第二部分：首部行/请求头信息

						- 每一行 = 首部字段名 + 值组成
						- 典型的字段

							- Host (必须)
							- Cookie （模拟登陆）
							- Content-Type (POST必须)
							- Content-Length (POST必须)
							- Referer (HTTP访问的来源)
							- Others

					- 第三部分：请求主体信息 (POST必须，用来提交表单等)

						- 主体信息格式

							- JSON
							- XML

				- 具体的 HTTP请求报文举例

					- GET / HTTP/1.1
Host: localhost
csrftoken: Zr6Sy6DpRMjMYjDGjHavuS9lwc5JLCt2MxMiogaNhd7pueKHwR4tbOcvJa5smoaz
					- POST / HTTP/1.1
Host: localhost
csrftoken: Zr6Sy6DpRMjMYjDGjHavuS9lwc5JLCt2MxMiogaNhd7pueKHwR4tbOcvJa5smoaz
Content-Length: 20 
Content-Type: application/x-www-form-urlencoded
					- PUT

				- HTTP 响应报文格式

					- 第一部分：响应行/初始状态行

						- 协议版本
						- 状态码

							- 1XX：接收到请求，继续处理
							- 2XX：请求成功，信息在返回的报文中
							- 3XX：请求重定向

								- 301： 请求被永久重定向到另一个地址，永久性转移(Permanently Moved)
								- 302： 请求被临时重定向到另一个地址，暂时性转移(Temporarily Moved )
								- 304：Not Modified （资源未修改，从本地（代理服务器）取缓存）
								- 307： 重定向中保持原有的 post 数据，防止数据丢失

							- 4XX：客户端请求错误，服务端不能理解

								- 403：客户端访问错误
								- 404：没有找到请求文件

							- 5XX：服务端出现问题

								- 505：HTTP version not support

						- 状态文字

							- 对于状态码的文字解释

					- 第二部分：首部行/响应头信息
					- 第三部分：响应主体信息（响应报文的主题部分）

						- 主体信息格式

							- 文本
							- 二进制文件

				- 具体的响应报文举例

		- 结合HTTP和应用程序建立的网络基础设施

			- Cookie机制，浏览器本地缓存

				- HTTP报文中 cookie首部行 + 用户本地cookie文件 + 服务器后端数据库
				- 状态信息的存储和隐私侵犯

			- Web缓存器，Web Cache/代理服务器Proxy Server

				- 缓存的功能分类

					- 私有缓存和公有缓存
					- 代理缓存和代理缓存的层次结构

						- 网状缓存和内容路由

					- 对等缓存关系

				- 缓存了客户端最近请求的对象。既是客户端也是服务器。

					- 缓存命中率
					- 优点：缩短响应时间，节省带宽。

				- 内容分发网络 Context Distribution Network
				- HTTP-条件GET方法

					- 首部行: If Modified Since

			- 服务器后端数据库

	- 文件传输与FTP
	- 电子邮件与SMTP
	- 目录服务与DNS
	- P2P与P2P协议
	- 流式视频
	- IP电话

### 运输层

- 两个端系统之间的交付服务，两个端系统进程之间的交付服务
- 运输层协议原理

	- 功能

		- 可靠传输
		- 拥塞控制

	- TCP

		- TCP连接的建立

	- DCP

### 网络层

### 链路层：链路、接入网和局域网

## 网络安全

## 网络管理

*XMind: ZEN - Trial Version*